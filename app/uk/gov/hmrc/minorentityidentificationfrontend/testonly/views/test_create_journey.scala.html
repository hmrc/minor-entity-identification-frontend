@*
 * Copyright 2022 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import uk.gov.hmrc.minorentityidentificationfrontend.config.AppConfig
@import uk.gov.hmrc.minorentityidentificationfrontend.models.{JourneyConfig, PageConfig}
@import uk.gov.hmrc.minorentityidentificationfrontend.views.html.templates.govuk_template
@import uk.gov.hmrc.govukfrontend.views.html.components._
@import uk.gov.hmrc.govukfrontend.views.html.components.implicits._
@import uk.gov.hmrc.hmrcfrontend.views.html.components.implicits._
@import uk.gov.hmrc.minorentityidentificationfrontend.views.html.helpers.{p, h1}
@import uk.gov.hmrc.minorentityidentificationfrontend.testonly.models.TestSetup

@this(layout: govuk_template,
    govukFieldset: GovukFieldset,
    govukButton: GovukButton,
    govukInput: GovukInput,
    formWithCSRF: FormWithCSRF,
    govukErrorSummary: GovukErrorSummary,
    govukCheckboxes: GovukCheckboxes,
    p: p,
    h1: h1,
    govukRadios: GovukRadios
)

@(pageConfig: PageConfig, form: Form[TestSetup], formAction: Call)(implicit request: Request[_], messages: Messages, appConfig: AppConfig)

@layout(pageConfig, "Enter Minor Entity Identification Journey Config") {

    @if(form.errors.nonEmpty) {
        @govukErrorSummary(ErrorSummary().withFormErrorsAsText(form))
    }

    @govukFieldset(Fieldset(
        legend = None,
        html = html
    ))

}

@html = {
    @formWithCSRF(action = formAction) {

        @h1("Journey Config")

        @p(Html("All URLs provided must be relative, apart from locally where localhost is allowed. If you need to call out to Business Verification (rather than stub it) all absolute urls will fail."))

        @govukInput(
            Input(
                label = Label(content=Text("Continue URL"),isPageHeading = false, classes = "govuk-label govuk-!-font-weight-bold"),
                hint = Some(Hint(content = Text("Must be relative for staging, qa and production"))),
                classes = "govuk-input--width-35"
            ).withFormField(form("continueUrl"))
        )

        @govukInput(
            Input(
                label = Label(content=Text("Service Name"),isPageHeading = false, classes = "govuk-label govuk-!-font-weight-bold"),
                classes = "govuk-input--width-20"
            ).withFormField(form("serviceName"))
        )

        @govukInput(
            Input(
                label = Label(content=Text("DeskPro Service Identifier"),isPageHeading = false, classes = "govuk-label govuk-!-font-weight-bold"),
                classes = "govuk-input--width-20"
            ).withFormField(form("deskProServiceId"))
        )

        @govukInput(
            Input(
                label = Label(content=Text("Sign Out Url"),isPageHeading = false, classes = "govuk-label govuk-!-font-weight-bold"),
                hint = Some(Hint(content = Text("Must be relative for staging, qa and production"))),
                classes = "govuk-input--width-35"
            ).withFormField(form("signOutUrl"))
        )

        @govukCheckboxes(Checkboxes(
            fieldset = Some(Fieldset(
                legend = Some(Legend(
                    content = Text("Business verification check"),
                        classes = "govuk-fieldset__legend--m",
                        isPageHeading = false
                    ))
                )),
                name = "Business verification check",
                items = Seq(
                    CheckboxItem(
                        id = Some("businessVerificationCheck"),
                        name = Some("businessVerificationCheck"),
                        content = Text("Enable business verification"),
                        checked = form("businessVerificationCheck").value == Some("true"),
                        value = "true"
            ))
        ))

        @govukInput(
            Input(
                label = Label(content=Text("Regime"),isPageHeading = false, classes = "govuk-label govuk-!-font-weight-bold"),
                classes = "govuk-input--width-20"
            ).withFormField(form("regime"))
        )

        @govukInput(
            Input(
                label = Label(content=Text("Accessibility Statement Url"),isPageHeading = false, classes = "govuk-label govuk-!-font-weight-bold"),
                hint = Some(Hint(content = Text("Must be relative for staging, qa and production"))),
                classes = "govuk-input--width-35"
            ).withFormField(form("accessibilityUrl"))
        )

        @govukInput(
            Input(
                label = Label(content=Text("Welsh translation for Service Name"),isPageHeading = false, classes = "govuk-label govuk-!-font-weight-bold"),
                classes = "govuk-input--width-20"
            ).withFormField(form("welshServiceName"))
        )

        @h1("Setup Journey Stubs")

        @govukRadios(Radios(
            fieldset = Some(Fieldset(
                legend = Some(Legend(
                content = Text("Trust Known Facts Stub response"),
                classes = "govuk-fieldset__legend--s",
                isPageHeading = false
                ))
            )),
            items = Seq(
                RadioItem(
                content = Text("Abroad Response"),
                value = Some("Abroad Response")
                ),
                RadioItem(
                content = Text("GB Response"),
                value = Some("GBResponse"),
                conditionalHtml = Some(postcodeHtml)
                ),
                RadioItem(
                content = Text("Not Found"),
                value = Some("Not Found")
                )
            )
        ).withFormField(form("knownFactsMatch")))

        @govukRadios(Radios(
            fieldset = Some(Fieldset(
            legend = Some(Legend(
                content = Text("Business Verification Stub response"),
                classes = "govuk-fieldset__legend--s",
                isPageHeading = false
                ))
            )),
            items = Seq(
                RadioItem(
                content = Text("Pass"),
                value = Some("Pass")
            ),
            RadioItem(
                content = Text("Fail"),
                value = Some("Fail")
            ),
        )
        ).withFormField(form("businessVerificationStub")))

        @govukRadios(Radios(
            fieldset = Some(Fieldset(
                legend = Some(Legend(
                content = Text("Registration Stub response"),
                classes = "govuk-fieldset__legend--s",
                isPageHeading = false
                ))
            )),
            items = Seq(
                RadioItem(
                    content = Text("Pass"),
                    value = Some("Pass"),
                    conditionalHtml = Some(registrationHtml)
                    ),
                RadioItem(
                    content = Text("Fail"),
                    value = Some("Fail")
                    ),
            )
        ).withFormField(form("registrationStub")))

        @govukButton(Button(
            attributes = Map("id" -> "save-and-continue"),
            classes = "govuk-!-margin-right-1",
            content = Text("Submit")
        ))
    }
}

@postcodeHtml = {
    @govukInput(
    Input(
        label = Label(content=Text("Postcode"),isPageHeading = false, classes = "govuk-label"),
        classes = "govuk-input--width-20"
        ).withFormField(form("postcode"))
    )
}

@registrationHtml = {
    @govukInput(
    Input(
        label = Label(content=Text("BP Safe ID"),isPageHeading = false, classes = "govuk-label"),
        classes = "govuk-input--width-20"
        ).withFormField(form("safeID"))
    )
}
